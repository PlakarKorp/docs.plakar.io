<!doctype html><html lang=en dir=ltr itemscope itemtype=http://schema.org/Article data-r-output-format=html><head><meta charset=utf-8><meta name=viewport content="height=device-height,width=device-width,initial-scale=1,minimum-scale=1"><meta name=generator content="Hugo 0.144.2"><meta name=generator content="Relearn 7.4.1+f1970c100345064760628503a0c0547304514659"><meta name=description content="This article will guide you through the creation of your first backup with plakar.
Installing plakar Requisites At the time of this writing, we do not yet provide packages and plakar has to be compiled from source, which requires the Go toolchain to be installed on your system.
To install the Go toolchain, please refer to the official documentation or run the following commands:"><meta name=author content="Gilles CHEHADE"><meta name=twitter:card content="summary"><meta name=twitter:title content="Quickstart - docs.plakar.io"><meta name=twitter:description content="This article will guide you through the creation of your first backup with plakar.
Installing plakar Requisites At the time of this writing, we do not yet provide packages and plakar has to be compiled from source, which requires the Go toolchain to be installed on your system.
To install the Go toolchain, please refer to the official documentation or run the following commands:"><meta property="og:url" content="https://docs.plakar.io/en/quickstart/index.html"><meta property="og:site_name" content="docs.plakar.io"><meta property="og:title" content="Quickstart - docs.plakar.io"><meta property="og:description" content="This article will guide you through the creation of your first backup with plakar.
Installing plakar Requisites At the time of this writing, we do not yet provide packages and plakar has to be compiled from source, which requires the Go toolchain to be installed on your system.
To install the Go toolchain, please refer to the official documentation or run the following commands:"><meta property="og:locale" content="en"><meta property="og:type" content="website"><meta itemprop=name content="Quickstart - docs.plakar.io"><meta itemprop=description content="This article will guide you through the creation of your first backup with plakar.
Installing plakar Requisites At the time of this writing, we do not yet provide packages and plakar has to be compiled from source, which requires the Go toolchain to be installed on your system.
To install the Go toolchain, please refer to the official documentation or run the following commands:"><meta itemprop=datePublished content="2025-03-03T17:00:00+01:00"><meta itemprop=dateModified content="2025-03-03T17:00:00+01:00"><meta itemprop=wordCount content="1622"><title>Quickstart - docs.plakar.io</title>
<link href=/en/quickstart/index.xml rel=alternate type=application/rss+xml title="Quickstart - docs.plakar.io"><link href=/fonts/fontawesome/css/fontawesome-all.min.css?1747149002 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/fonts/fontawesome/css/fontawesome-all.min.css?1747149002 rel=stylesheet></noscript><link href=/css/perfect-scrollbar/perfect-scrollbar.min.css?1747149002 rel=stylesheet><link href=/css/theme.min.css?1747149002 rel=stylesheet><link href=/css/format-html.min.css?1747149002 rel=stylesheet id=R-format-style><link href=/css/auto-complete/auto-complete.min.css?1747149002 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/css/auto-complete/auto-complete.css?1747149002 rel=stylesheet></noscript><script src=/js/auto-complete/auto-complete.min.js?1747149002 defer></script><script src=/js/lunr/lunr.min.js?1747149002 defer></script><script src=/js/lunr/lunr.stemmer.support.min.js?1747149002 defer></script><script src=/js/lunr/lunr.multi.min.js?1747149002 defer></script><script src=/js/lunr/lunr.en.min.js?1747149002 defer></script><script src=/js/search.min.js?1747149002 defer></script><script>window.relearn=window.relearn||{},window.relearn.min=`.min`,window.relearn.relBasePath="../..",window.relearn.relBaseUri="../..",window.relearn.absBaseUri="https://docs.plakar.io",window.relearn.contentLangs=["en"],window.relearn.index_js_url="/searchindex.en.js?1747149002",window.relearn.disableAnchorCopy=!1,window.relearn.disableAnchorScrolling=!1,window.relearn.disableInlineCopyToClipboard=!1,window.relearn.enableBlockCodeWrap=!0,window.relearn.themevariants=["blue"],window.relearn.customvariantname="my-custom-variant",window.relearn.changeVariant=function(e){var t=document.documentElement.dataset.rThemeVariant;window.localStorage.setItem(window.relearn.absBaseUri+"/variant",e),document.documentElement.dataset.rThemeVariant=e,t!=e&&document.dispatchEvent(new CustomEvent("themeVariantLoaded",{detail:{variant:e,oldVariant:t}}))},window.relearn.markVariant=function(){var t=window.localStorage.getItem(window.relearn.absBaseUri+"/variant"),e=document.querySelector("#R-select-variant");e&&(e.value=t)},window.relearn.initVariant=function(){var e=window.localStorage.getItem(window.relearn.absBaseUri+"/variant")??"";e==window.relearn.customvariantname||(!e||!window.relearn.themevariants.includes(e))&&(e=window.relearn.themevariants[0],window.localStorage.setItem(window.relearn.absBaseUri+"/variant",e)),document.documentElement.dataset.rThemeVariant=e},window.relearn.initVariant(),window.relearn.markVariant(),window.T_Copy_to_clipboard=`Copy to clipboard`,window.T_Copied_to_clipboard=`Copied to clipboard!`,window.T_Copy_link_to_clipboard=`Copy link to clipboard`,window.T_Link_copied_to_clipboard=`Copied link to clipboard!`,window.T_Reset_view=`Reset view`,window.T_View_reset=`View reset!`,window.T_No_results_found=`No results found for "{0}"`,window.T_N_results_found=`{1} results found for "{0}"`</script></head><body class="mobile-support html" data-url=/en/quickstart/index.html><div id=R-body class=default-animation><div id=R-body-overlay></div><nav id=R-topbar><div class=topbar-wrapper><div class=topbar-sidebar-divider></div><div class="topbar-area topbar-area-start" data-area=start><div class="topbar-button topbar-button-sidebar" data-content-empty=disable data-width-s=show data-width-m=hide data-width-l=hide><button class=topbar-control onclick=toggleNav() type=button title="Menu (CTRL+ALT+n)"><i class="fa-fw fas fa-bars"></i></button></div><div class="topbar-button topbar-button-toc" data-content-empty=hide data-width-s=show data-width-m=show data-width-l=show><button class=topbar-control onclick=toggleTopbarFlyout(this) type=button title="Table of Contents (CTRL+ALT+t)"><i class="fa-fw fas fa-list-alt"></i></button><div class=topbar-content><div class=topbar-content-wrapper><nav class=TableOfContents><ul><li><a href=#installing-plakar>Installing plakar</a></li><li><a href=#running-the-local-agent>Running the local agent</a></li><li><a href=#creating-your-first-local-repository>Creating your first local repository</a></li><li><a href=#creating-your-first-local-backup>Creating your first local backup</a></li><li><a href=#viewing-the-backup-with-the-web-interface>Viewing the backup with the web interface</a></li><li><a href=#digression-one-copy-is-not-enough>Digression: one copy is not enough</a></li><li><a href=#creating-a-second-copy-over-sftp>Creating a second copy over SFTP</a></li><li><a href=#creating-a-third-copy-over-s3>Creating a third copy over S3</a></li><li><a href=#a-few-additional-words-on-synchronization>A few additional words on synchronization</a></li></ul></nav></div></div></div></div><ol class="topbar-breadcrumbs breadcrumbs highlightable" itemscope itemtype=http://schema.org/BreadcrumbList><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=/en/index.html><span itemprop=name>docs.plakar.io</span></a><meta itemprop=position content="1">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><span itemprop=name>Quickstart</span><meta itemprop=position content="2"></li></ol><div class="topbar-area topbar-area-end" data-area=end><div class="topbar-button topbar-button-prev" data-content-empty=disable data-width-s=show data-width-m=show data-width-l=show><a class=topbar-control href=/en/index.html title="docs.plakar.io (🡐)"><i class="fa-fw fas fa-chevron-left"></i></a></div><div class="topbar-button topbar-button-next" data-content-empty=disable data-width-s=show data-width-m=show data-width-l=show><a class=topbar-control href=/en/quickstart/probabilities/index.html title="One repository is not enough (🡒)"><i class="fa-fw fas fa-chevron-right"></i></a></div><div class="topbar-button topbar-button-more" data-content-empty=hide data-width-s=show data-width-m=show data-width-l=show><button class=topbar-control onclick=toggleTopbarFlyout(this) type=button title=More><i class="fa-fw fas fa-ellipsis-v"></i></button><div class=topbar-content><div class=topbar-content-wrapper><div class="topbar-area topbar-area-more" data-area=more></div></div></div></div></div></div></nav><div id=R-main-overlay></div><main id=R-body-inner class="highlightable quickstart" tabindex=-1><div class=flex-block-wrapper><article class=default><header class=headline></header><h1 id=quickstart>Quickstart</h1><p>This article will guide you through the creation of your first backup with plakar.</p><h2 id=installing-plakar>Installing plakar</h2><details open class="box cstyle notices info"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-circle-info"></i>
Requisites</summary><div class=box-content><p>At the time of this writing, we do not yet provide packages and <strong>plakar</strong> has to be compiled from source, which requires the Go toolchain to be installed on your system.</p><p>To install the Go toolchain, please refer to the <a href=https://golang.org/doc/install rel=external target=_blank>official documentation</a> or run the following commands:</p><ul><li><strong>MacOS</strong>: <code>brew install go</code></li><li><strong>Debian/Ubuntu</strong>: <code>sudo apt-get update && sudo apt-get install -y ca-certificates golang</code></li><li><strong>OpenBSD</strong>: <code>doas pkg_add go</code></li></ul><p>By default, <em>plakar</em> is installed in <em>~/go/bin</em>. Run <code>export PATH=$PATH:~/go/bin</code> to add it to your PATH.</p></div></details><p>Install <strong>plakar</strong>:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ go install github.com/PlakarKorp/plakar/cmd/plakar@latest</span></span></code></pre></div><p>To verify the installation was successful, run:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ plakar version
</span></span><span style=display:flex><span>plakar/v1.0.1-main
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>importers: fs, ftp, s3, sftp, stdin
</span></span><span style=display:flex><span>exporters: fs, ftp, s3, sftp, stderr, stdout
</span></span><span style=display:flex><span>klosets: fs, http, https, ptar, s3, sftp, sqlite</span></span></code></pre></div><h2 id=running-the-local-agent>Running the local agent</h2><p>To work efficiently,
<strong>plakar</strong> requires each user to run a local agent that will provide caching among other things.
Although the agent is not strictly mandatory, it is highly recommended for optimal performance.
If the agent is not running, the <strong>plakar</strong> CLI will fail for most commands unless explicitly set to run without,
in which case it will disallow concurrent commands and won&rsquo;t benefit from caching.</p><p>Start the agent:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ plakar agent
</span></span><span style=display:flex><span>agent started with pid<span style=color:#f92672>=</span><span style=color:#ae81ff>12539</span></span></span></code></pre></div><p>The agent can be stopped with the following command:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ plakar agent stop</span></span></code></pre></div><p><em>If you follow the quickstart but the agent is not running, you can force <strong>plakar</strong> to run anyway by setting the PLAKAR_AGENTLESS environment variable as such <code>export PLAKAR_AGENTLESS=</code></em></p><h2 id=creating-your-first-local-repository>Creating your first local repository</h2><p>The <strong>plakar</strong> software reads your data,
splits it into smaller chunks that it deduplicates and stores in a <strong>repository</strong>,
a fancy word to designate storage space dedicated to hold these chunks.</p><p>A <strong>repository</strong> can be a directory on your local filesystem,
a mountpoint to your NAS,
a remote directory over SFTP,
a bucket on an S3 object store,
or any storage we provide (or you write) a connector for.</p><p>Our first repository will be a directory at <code>/var/backups</code>:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ plakar at /var/backups create
</span></span><span style=display:flex><span>repository passphrase: 
</span></span><span style=display:flex><span>repository passphrase <span style=color:#f92672>(</span>confirm<span style=color:#f92672>)</span>:</span></span></code></pre></div><details open class="box cstyle notices warning"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-triangle-exclamation"></i>
Your passphrase is important</summary><div class=box-content><p>Be extra careful when chosing the passphrase:
it is the secret protecting your data.
People with both access to the repository and knowledge of the passphrase can read your backups.</p><p><strong>DO NOT LOSE OR FORGET THE PASSPHRASE:</strong>
it is not stored anywhere and can&rsquo;t be recovered in case of loss.
A lost passphrase means the data within the repository can no longer be recovered.</p></div></details><p>It is also possible to create unencrypted repositories,
should your backups remain local,
in which case the <code>-no-encryption</code> option has to be passed at creation:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ plakar at /var/backups create -no-encryption</span></span></code></pre></div><p>Note that once a repository is created,
it is no longer possible to change its configuration,
such changes require creating a new repository and performing a synchronization between old and new repository.</p><h2 id=creating-your-first-local-backup>Creating your first local backup</h2><p>Once the repository is created, we can do the first backup to it:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ plakar at /var/backups backup /private/etc
</span></span><span style=display:flex><span>9abc3294: OK ✓ /private/etc/ftpusers
</span></span><span style=display:flex><span>9abc3294: OK ✓ /private/etc/asl/com.apple.iokit.power
</span></span><span style=display:flex><span>9abc3294: OK ✓ /private/etc/pam.d/screensaver_new_ctk
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>...<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>9abc3294: OK ✓ /private/etc/apache2
</span></span><span style=display:flex><span>9abc3294: OK ✓ /private/etc
</span></span><span style=display:flex><span>9abc3294: OK ✓ /private
</span></span><span style=display:flex><span>9abc3294: OK ✓ /
</span></span><span style=display:flex><span>backup: created unsigned snapshot 9abc3294 of size 3.1 MB in 72.55875ms</span></span></code></pre></div><p>You can verify that it is properly recorded:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ plakar at /var/backups ls
</span></span><span style=display:flex><span>2025-02-19T21:38:16Z   9abc3294    3.1 MB      0s   /private/etc</span></span></code></pre></div><p>Verify the integrity of its content:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ plakar at /var/backups check 9abc3294
</span></span><span style=display:flex><span>9abc3294: ✓ /private/etc/afpovertcp.cfg
</span></span><span style=display:flex><span>9abc3294: ✓ /private/etc/apache2/extra/httpd-autoindex.conf
</span></span><span style=display:flex><span>9abc3294: ✓ /private/etc/apache2/extra/httpd-dav.conf
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>...<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>9abc3294: ✓ /private/etc/xtab
</span></span><span style=display:flex><span>9abc3294: ✓ /private/etc/zshrc
</span></span><span style=display:flex><span>9abc3294: ✓ /private/etc/zshrc_Apple_Terminal
</span></span><span style=display:flex><span>9abc3294: ✓ /private/etc
</span></span><span style=display:flex><span>check: verification of 9abc3294:/private/etc completed successfully</span></span></code></pre></div><p>And restore it to a local directory:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ plakar at /var/backups restore -to /tmp/restore 9abc3294
</span></span><span style=display:flex><span>9abc3294: OK ✓ /private/etc/afpovertcp.cfg
</span></span><span style=display:flex><span>9abc3294: OK ✓ /private/etc/apache2/extra/httpd-autoindex.conf
</span></span><span style=display:flex><span>9abc3294: OK ✓ /private/etc/apache2/extra/httpd-dav.conf
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>...<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>9abc3294: OK ✓ /private/etc/xtab
</span></span><span style=display:flex><span>9abc3294: OK ✓ /private/etc/zprofile
</span></span><span style=display:flex><span>9abc3294: OK ✓ /private/etc/zshrc
</span></span><span style=display:flex><span>9abc3294: OK ✓ /private/etc/zshrc_Apple_Terminal
</span></span><span style=display:flex><span>restore: restoration of 9abc3294:/private/etc at /tmp/restore completed successfully
</span></span><span style=display:flex><span>$ ls -l /tmp/restore
</span></span><span style=display:flex><span>total <span style=color:#ae81ff>1784</span>
</span></span><span style=display:flex><span>-rw-r--r--@  <span style=color:#ae81ff>1</span> gilles  wheel     <span style=color:#ae81ff>515</span> Feb <span style=color:#ae81ff>19</span> 22:47 afpovertcp.cfg
</span></span><span style=display:flex><span>drwxr-xr-x@  <span style=color:#ae81ff>9</span> gilles  wheel     <span style=color:#ae81ff>288</span> Feb <span style=color:#ae81ff>19</span> 22:47 apache2
</span></span><span style=display:flex><span>drwxr-xr-x@ <span style=color:#ae81ff>16</span> gilles  wheel     <span style=color:#ae81ff>512</span> Feb <span style=color:#ae81ff>19</span> 22:47 asl
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>...<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>-rw-r--r--@  <span style=color:#ae81ff>1</span> gilles  wheel       <span style=color:#ae81ff>0</span> Feb <span style=color:#ae81ff>19</span> 22:47 xtab
</span></span><span style=display:flex><span>-r--r--r--@  <span style=color:#ae81ff>1</span> gilles  wheel     <span style=color:#ae81ff>255</span> Feb <span style=color:#ae81ff>19</span> 22:47 zprofile
</span></span><span style=display:flex><span>-r--r--r--@  <span style=color:#ae81ff>1</span> gilles  wheel    <span style=color:#ae81ff>3094</span> Feb <span style=color:#ae81ff>19</span> 22:47 zshrc
</span></span><span style=display:flex><span>-rw-r--r--@  <span style=color:#ae81ff>1</span> gilles  wheel    <span style=color:#ae81ff>9335</span> Feb <span style=color:#ae81ff>19</span> 22:47 zshrc_Apple_Terminal</span></span></code></pre></div><h2 id=viewing-the-backup-with-the-web-interface>Viewing the backup with the web interface</h2><p>Plakar provides a web interface to view the backups and their content. To start the web interface, run:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ plakar at /var/backups ui</span></span></code></pre></div><p>Your default browser will open a new tab. You can navigate through the snapshots, view the files, and restore them.</p><p><a href=#R-image-20c0514fdc5695d1ef127f507f80a9e2 class=lightbox-link><img alt="Web UI, light mode" class="lazy lightbox figure-image" loading=lazy src=/en/quickstart/images/ui-light.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-20c0514fdc5695d1ef127f507f80a9e2><img alt="Web UI, light mode" class="lazy lightbox lightbox-image" loading=lazy src=/en/quickstart/images/ui-light.png></a>
<a href=#R-image-4fdf694ac4c1c23b4b74bd9ce0dc84fd class=lightbox-link><img alt="Web UI, dark mode" class="lazy lightbox figure-image" loading=lazy src=/en/quickstart/images/ui-dark.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-4fdf694ac4c1c23b4b74bd9ce0dc84fd><img alt="Web UI, dark mode" class="lazy lightbox lightbox-image" loading=lazy src=/en/quickstart/images/ui-dark.png></a></p><h2 id=digression-one-copy-is-not-enough>Digression: one copy is not enough</h2><p>You&rsquo;ve completed a backup, which is great. However, if you&rsquo;ll allow me, I&rsquo;d like to digress for a moment:</p><blockquote><p>Literature and empirical studies suggest that the annual probability of data loss at a single site—especially when considering factors like hardware failures, human error, and environmental risks—is typically in the low single-digit percentages. For example, a seminal study by Pinheiro, Weber, and Barroso (2007) titled <a href=https://static.googleusercontent.com/media/research.google.com/en//archive/disk_failures.pdf rel=external target=_blank>&ldquo;Failure Trends in a Large Disk Drive Population&rdquo;</a> found that hard drive failure rates generally fall in the range of 2% to 4% per year. In practice, when additional risks beyond basic hardware failure (such as accidental deletion or other operational issues) are factored in, many practitioners adopt a conservative estimate of around 5% per year for a single site.</p></blockquote><p>A local backup, as we just did, is helpful in case of accidental removal of the original data&mldr; but not so much if the storage is entirely lost.</p><p>As explained in the page <a href=/en/quickstart/probabilities/index.html>One repository is not enough</a>, the probability of losing data is as follows:</p><ul><li>For a single set of data: 5% per year (1 in 20 chance)</li><li>For two copies at distinct sites: 0.00069% per year (1 in 145,000 chance)</li><li>For three copies at distinct sites: 0.0000001% per year (1 in a billion chance)</li></ul><p>To reduce the risk of data loss, it is highly recommended to create multiple copies of your backups across different locations.</p><h2 id=creating-a-second-copy-over-sftp>Creating a second copy over SFTP</h2><p>We now have a local repository with a copy of our backups, but it is done on the same machine: <strong>we&rsquo;re currently at 5% chances of losing data this year if the drive dies</strong>.</p><p>Plakar has been designed to make it easy to synchronize repositories across multiple locations. Let&rsquo;s create another repository on my remote NAS over SFTP and synchronize it with the local one: it should not take more than a couple of minutes.</p><details open class="box cstyle notices grey"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-circle-question"></i>
What is SFTP?</summary><div class=box-content><p>SFTP is the Secure File Transfer Protocol that comes with OpenSSH.</p></div></details><p>This can be done by creating a new repository there,
with its own passphrase:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ plakar at sftp://gilles@nas.plakar.io/var/backups create
</span></span><span style=display:flex><span>repository passphrase: 
</span></span><span style=display:flex><span>repository passphrase <span style=color:#f92672>(</span>confirm<span style=color:#f92672>)</span>:</span></span></code></pre></div><p>We could simply do a new backup to it, but this might produce different snapshots as data may have changed since the first backup.</p><p>Instead, we can perform a repository synchronization.</p><p>A repository synchronization ensures that backups are transfered from a repository to another, using the recorded data,and performing necessary decryption and encryption to produce a similar copy:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ plakar at /var/backups sync to sftp://gilles@nas.plakar.io/var/backups
</span></span><span style=display:flex><span>peer repository passphrase: 
</span></span><span style=display:flex><span>peer repository passphrase <span style=color:#f92672>(</span>confirm<span style=color:#f92672>)</span>:
</span></span><span style=display:flex><span>sync: synchronized <span style=color:#ae81ff>1</span> snapshot
</span></span><span style=display:flex><span>info: sync: synchronization from /var/backups to sftp://gilles@nas.plakar.io/var/backups completed: <span style=color:#ae81ff>1</span> snapshots synchronized
</span></span><span style=display:flex><span>$ plakar at sftp://gilles@nas.plakar.io/var/backups ls
</span></span><span style=display:flex><span>2025-02-19T21:38:16Z   9abc3294    3.1 MB      0s   /private/etc</span></span></code></pre></div><p>We can verify integrity of the snapshot on the second repository:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ plakar at sftp://gilles@nas.plakar.io/var/backups check 9abc3294
</span></span><span style=display:flex><span>9abc3294: ✓ /private/etc/afpovertcp.cfg
</span></span><span style=display:flex><span>9abc3294: ✓ /private/etc/apache2/extra/httpd-autoindex.conf
</span></span><span style=display:flex><span>9abc3294: ✓ /private/etc/apache2/extra/httpd-dav.conf
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>...<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>9abc3294: ✓ /private/etc/xtab
</span></span><span style=display:flex><span>9abc3294: ✓ /private/etc/zshrc
</span></span><span style=display:flex><span>9abc3294: ✓ /private/etc/zshrc_Apple_Terminal
</span></span><span style=display:flex><span>9abc3294: ✓ /private/etc
</span></span><span style=display:flex><span>check: verification of 9abc3294:/ completed successfully</span></span></code></pre></div><p><strong>The probability of losing data this year has now fallen from 5% to 0.00069% (1 in 145,000)!</strong></p><h2 id=creating-a-third-copy-over-s3>Creating a third copy over S3</h2><p>But what if both my drive died AND the data center hosting my NAS burst in flames?</p><p>Let’s create yet another repository on a remote S3 bucket!</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ plakar config repository create s3
</span></span><span style=display:flex><span><span style=color:#75715e># for AWS, set s3://s3.&lt;region&gt;.amazonaws.com/&lt;bucket&gt;</span>
</span></span><span style=display:flex><span>$ plakar config repository set s3 location s3://minio.plakar.io:9001/mybackups
</span></span><span style=display:flex><span>$ plakar config repository set s3 passphrase ****************
</span></span><span style=display:flex><span>$ plakar config repository set s3 access_key gilles
</span></span><span style=display:flex><span>$ plakar config repository set s3 secret_access_key ********
</span></span><span style=display:flex><span>$ plakar at @s3 create</span></span></code></pre></div><p>Let&rsquo;s do another synchronization!</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ plakar at /var/backups sync to @s3
</span></span><span style=display:flex><span>sync: synchronization from /var/backups to s3://minio.plakar.io:9001/mybackups completed: <span style=color:#ae81ff>1</span> snapshots synchronized
</span></span><span style=display:flex><span>$ plakar at @s3 ls
</span></span><span style=display:flex><span>2025-02-19T21:38:16Z   9abc3294    3.1 MB      0s   /private/etc</span></span></code></pre></div><p>We can verify integrity of the snapshot on the third repository:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ plakar at @s3 check 9abc3294
</span></span><span style=display:flex><span>9abc3294: ✓ /private/etc/afpovertcp.cfg
</span></span><span style=display:flex><span>9abc3294: ✓ /private/etc/apache2/extra/httpd-autoindex.conf
</span></span><span style=display:flex><span>9abc3294: ✓ /private/etc/apache2/extra/httpd-dav.conf
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>...<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>9abc3294: ✓ /private/etc/xtab
</span></span><span style=display:flex><span>9abc3294: ✓ /private/etc/zshrc
</span></span><span style=display:flex><span>9abc3294: ✓ /private/etc/zshrc_Apple_Terminal
</span></span><span style=display:flex><span>9abc3294: ✓ /private/etc
</span></span><span style=display:flex><span>check: verification of 9abc3294:/private/etc completed successfully</span></span></code></pre></div><p><strong>The probability of losing data has now fallen from 0.00069% to 0.0000001% (1 in a billion)!</strong></p><h2 id=a-few-additional-words-on-synchronization>A few additional words on synchronization</h2><p>Repository synchronization is slightly more advanced than what was shown,
and you are encouraged to experiment with it to find the best worflow for your use-case.</p><p>This first command locates snapshots that exist in my local repository but not in the remote one,
then sends them over:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ plakar at /var/backups sync to @s3</span></span></code></pre></div><p>This second command locates snapshots that exist in the remote repository but not in the local one to bring them over:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ plakar at /var/backups sync from @s3</span></span></code></pre></div><p>And this last command does it both ways, pushing to the remote repositories snapshots that exist locally and are missing, but also fetching locally snapshots that only exist remotely:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ plakar at /var/backups sync with @s3</span></span></code></pre></div><p>In addition, all these commands support passing snapshot identifiers and various options to perform partial synchronizations, only exchanging snapshots that match certain criterias. More information can be found in the <a href=/commands/sync/>documentation</a>.</p><footer class=footline><i class='fa-fw fas fa-calendar'></i> Mar 3, 2025</footer></article></div></main></div><aside id=R-sidebar class="default-animation showVisitedLinks"><div id=R-header-topbar class=default-animation></div><div id=R-header-wrapper class=default-animation><div id=R-header class=default-animation><a id=R-logo class=R-default href=/en/index.html><div class=logo-title>docs.plakar.io</div></a></div><search><form action=/en/search/index.html method=get><div class="searchbox default-animation"><button class=search-detail type=submit title="Search (CTRL+ALT+f)"><i class="fas fa-search"></i></button>
<label class=a11y-only for=R-search-by>Search</label>
<input data-search-input id=R-search-by name=search-by class=search-by type=search placeholder=Search...>
<button class=search-clear type=button data-search-clear title="Clear search"><i class="fas fa-times" title="Clear search"></i></button></div></form></search></div><div id=R-homelinks class="default-animation homelinks"><ul><li><a class=padding href=/en/index.html><i class="fa-fw fas fa-home"></i> Home</a></li></ul><hr class=padding></div><div id=R-content-wrapper class=highlightable><div id=R-shortcutmenu-home class=R-sidebarmenu><ul class="enlarge morespace collapsible-menu"><li class="active parent" data-nav-id=/en/quickstart/index.html><a class=padding href=/en/quickstart/index.html><b>1. </b>Quickstart<i class="fa-fw fas fa-check read-icon"></i></a><ul id=R-subsections-d63193e927818b6cb77d9c791ea48a61 class=collapsible-menu><li data-nav-id=/en/quickstart/probabilities/index.html><a class=padding href=/en/quickstart/probabilities/index.html>One repository is not enough<i class="fa-fw fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/en/concepts/index.html><a class=padding href=/en/concepts/index.html><b>2. </b>Concepts<i class="fa-fw fas fa-check read-icon"></i></a></li><li data-nav-id=/en/commands/index.html><a class=padding href=/en/commands/index.html><b>3. </b>Commands<i class="fa-fw fas fa-check read-icon"></i></a><ul id=R-subsections-118e8fa4eebe2c925610d50578ae00e0 class=collapsible-menu></ul></li><li data-nav-id=/en/community/index.html><a class=padding href=/en/community/index.html><b>4. </b>Community<i class="fa-fw fas fa-check read-icon"></i></a></li></ul></div><div class="padding footermargin footerLangSwitch footerVariantSwitch footerVisitedLinks footerFooter showLangSwitch showVisitedLinks showFooter"></div><div id=R-menu-footer><hr class="padding default-animation footerLangSwitch footerVariantSwitch footerVisitedLinks footerFooter showLangSwitch showVisitedLinks showFooter"><div id=R-prefooter class="footerLangSwitch footerVariantSwitch footerVisitedLinks showLangSwitch showVisitedLinks"><ul><li id=R-select-language-container class="footerLangSwitch showLangSwitch"><div class="padding menu-control"><i class="fa-fw fas fa-language"></i>
<span>&nbsp;</span><div class=control-style><label class=a11y-only for=R-select-language>Language</label>
<select id=R-select-language onchange="location=this.querySelector(this.value).dataset.url"><option id=R-select-language-en value=#R-select-language-en data-url=/en/quickstart/index.html lang=en selected>English</option></select></div><div class=clear></div></div></li><li id=R-select-variant-container class=footerVariantSwitch><div class="padding menu-control"><i class="fa-fw fas fa-paint-brush"></i>
<span>&nbsp;</span><div class=control-style><label class=a11y-only for=R-select-variant>Theme</label>
<select id=R-select-variant onchange=window.relearn.changeVariant(this.value)><option id=R-select-variant-blue value=blue selected>Blue</option></select></div><div class=clear></div></div><script>window.relearn.markVariant()</script></li><li class="footerVisitedLinks showVisitedLinks"><div class="padding menu-control"><i class="fa-fw fas fa-history"></i>
<span>&nbsp;</span><div class=control-style><button onclick=clearHistory()>Clear History</button></div><div class=clear></div></div></li></ul></div><div id=R-footer class="footerFooter showFooter"><p>Built with <a href=https://github.com/McShelby/hugo-theme-relearn title=love><i class="fas fa-heart"></i></a> by <a href=https://gohugo.io/>Hugo</a></p></div></div></div></aside><script src=/js/clipboard/clipboard.min.js?1747149002 defer></script><script src=/js/perfect-scrollbar/perfect-scrollbar.min.js?1747149002 defer></script><script src=/js/theme.min.js?1747149002 defer></script></body></html>